<div class="trade-container">
  <div class="trade-header">
    <h1 class="trade-title">Item Trading</h1>
    <a href="/town/visit/trade" class="btn-back">
      <i class="fas fa-arrow-left"></i> Back to Trade Center
    </a>
  </div>

  <% if (typeof message !== 'undefined' && message) { %>
    <div class="alert alert-<%= messageType || 'info' %>">
      <%= message %>
    </div>
  <% } %>

  <div class="trainer-selectors">
    <!-- Your Trainer Selection -->
    <div class="trainer-selector">
      <form class="trainer-form">
        <label class="trainer-label" for="yourTrainer">Your Trainer:</label>
        <select class="trainer-select" id="yourTrainer" name="initiator_id">
          <option value="">Select your trainer...</option>
          <% (typeof userTrainers !== 'undefined' && userTrainers ? userTrainers : []).forEach(trainer => { %>
            <option value="<%= trainer.id %>" <%= (selectedTrainer && selectedTrainer.id === trainer.id) ? 'selected' : '' %>>
              <%= trainer.name %>
            </option>
          <% }); %>
        </select>
      </form>
    </div>

    <!-- Trade Partner Selection -->
    <div class="trainer-selector">
      <form class="trainer-form">
        <label class="trainer-label" for="tradePartner">Trade Partner:</label>
        <select class="trainer-select" id="tradePartner" name="recipient_id">
          <option value="">Choose a trade partner...</option>
          <% (typeof otherTrainers !== 'undefined' && otherTrainers ? otherTrainers : []).forEach(trainer => { %>
            <option value="<%= trainer.id %>"><%= trainer.name %></option>
          <% }); %>
        </select>
      </form>
    </div>
  </div>

  <style>
    .trainer-selectors {
      display: flex;
      gap: 2rem;
      margin-bottom: 2rem;
    }

    .trainer-selector {
      flex: 1;
      background-color: var(--card-background);
      border-radius: 0.5rem;
      padding: 1.5rem;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    }

    .trainer-form {
      display: flex;
      flex-direction: column;
      gap: 0.75rem;
    }

    .trainer-label {
      font-size: 1rem;
      font-weight: 600;
      color: var(--accent-color);
    }

    .trainer-select {
      width: 100%;
      padding: 0.75rem;
      border-radius: 0.5rem;
      border: 1px solid var(--divider-color);
      background-color: var(--input-background);
      color: var(--text-color);
      font-size: 1rem;
      cursor: pointer;
      transition: all 0.2s ease;
      appearance: none;
      background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='%23d6a339'%3E%3Cpath d='M7 10l5 5 5-5z'/%3E%3C/svg%3E");
      background-repeat: no-repeat;
      background-position: right 0.75rem center;
      background-size: 1.5rem;
    }

    .trainer-select:hover {
      border-color: var(--accent-color);
    }

    .trainer-select:focus {
      outline: none;
      border-color: var(--accent-color);
      box-shadow: 0 0 0 2px rgba(214, 163, 57, 0.2);
    }

    .search-container {
      margin-bottom: 1rem;
    }

    .search-input {
      width: 100%;
      padding: 0.75rem 1rem;
      border: 1px solid var(--divider-color);
      border-radius: 0.5rem;
      background-color: var(--input-background);
      color: var(--text-color);
      font-size: 1rem;
      transition: all 0.2s ease;
    }

    .search-input:hover {
      border-color: var(--accent-color);
    }

    .search-input:focus {
      outline: none;
      border-color: var(--accent-color);
      box-shadow: 0 0 0 2px rgba(214, 163, 57, 0.2);
    }

    @media (max-width: 768px) {
      .trainer-selectors {
        flex-direction: column;
        gap: 1rem;
      }
    }
  </style>

  <div class="trade-grid">
    <!-- Your Items Section -->
    <div class="trade-section">
      <h2 class="trade-section-title">
        <i class="fas fa-box-open"></i> Your Items
      </h2>

      <!-- Category Selection -->
      <div class="inventory-tabs" id="your-categories"></div>

      <!-- Search Container -->
      <div class="search-container">
        <input type="text"
               class="search-input"
               placeholder="Search your items..."
               id="your-items-search">
      </div>

      <!-- Items Grid -->
      <div class="monster-list">
        <div id="your-items-container" class="monster-grid"></div>
      </div>

      <!-- Selected Items -->
      <div class="selected-monsters">
        <h3 class="selected-monsters-title">Selected Items</h3>
        <div id="offered-items-list" class="selected-monsters-list"></div>
      </div>
    </div>

    <!-- Their Items Section -->
    <div class="trade-section">
      <h2 class="trade-section-title">
        <i class="fas fa-box"></i> Their Items
      </h2>

      <!-- Category Selection -->
      <div class="inventory-tabs" id="their-categories"></div>

      <!-- Search Container -->
      <div class="search-container">
        <input type="text"
               class="search-input"
               placeholder="Search their items..."
               id="their-items-search">
      </div>

      <!-- Items Grid -->
      <div class="monster-list">
        <div id="their-items-container" class="monster-grid"></div>
      </div>

      <!-- Selected Items -->
      <div class="selected-monsters">
        <h3 class="selected-monsters-title">Selected Items</h3>
        <div id="requested-items-list" class="selected-monsters-list"></div>
      </div>
    </div>
  </div>

  <!-- Trade Form -->
  <div class="trade-actions">
    <form id="trade-form" action="/town/visit/trade/items" method="POST">
      <input type="hidden" name="initiator_id" id="initiator_id">
      <input type="hidden" name="recipient_id" id="recipient_id">
      <div id="offered-items-inputs"></div>
      <div id="requested-items-inputs"></div>
      <button type="submit" class="btn-submit">
        <i class="fas fa-exchange-alt"></i> Propose Trade
      </button>
    </form>
  </div>
</div>

<style>
  .trade-container {
    max-width: 1200px;
    margin: 0 auto;
    padding: 2rem 1rem;
  }

  .trade-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 2rem;
  }

  .trade-title {
    font-size: 2rem;
    font-weight: bold;
    color: var(--accent-color);
  }

  .btn-back {
    display: inline-flex;
    align-items: center;
    gap: 0.5rem;
    background-color: var(--card-background);
    color: var(--text-color);
    padding: 0.5rem 1rem;
    border-radius: 0.5rem;
    text-decoration: none;
    transition: background-color 0.3s ease;
  }

  .btn-back:hover {
    background-color: var(--nav-hover);
  }

  .trade-grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 2rem;
    margin-bottom: 2rem;
  }

  .trade-section {
    background-color: var(--card-background);
    border-radius: 1rem;
    padding: 1.5rem;
  }

  .trade-section-title {
    font-size: 1.25rem;
    font-weight: bold;
    color: var(--accent-color);
    margin-bottom: 1rem;
    display: flex;
    align-items: center;
    gap: 0.5rem;
  }

  .inventory-tabs {
    display: flex;
    flex-wrap: wrap;
    gap: 0.5rem;
    margin-bottom: 1rem;
  }

  .category-btn {
    padding: 0.5rem 1rem;
    border-radius: 0.5rem;
    border: none;
    background-color: var(--nav-background);
    color: var(--text-color);
    cursor: pointer;
    transition: all 0.2s;
  }

  .category-btn:hover {
    background-color: var(--nav-hover);
  }

  .category-btn.active {
    background-color: var(--accent-color);
    color: white;
  }

  .monster-list {
    background-color: rgba(0, 0, 0, 0.1);
    border-radius: 0.5rem;
    padding: 1rem;
    min-height: 250px;
    max-height: 400px;
    overflow-y: auto;
  }

  .monster-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
    gap: 0.75rem;
  }

  .item-card {
    background-color: var(--nav-background);
    border-radius: 0.375rem;
    padding: 0.75rem;
    cursor: pointer;
    transition: all 0.2s;
  }

  .item-card:hover {
    transform: translateY(-2px);
    background-color: var(--nav-hover);
  }

  .item-card.selected {
    border: 2px solid var(--accent-color);
  }

  .item-image {
    width: 48px;
    height: 48px;
    margin: 0 auto 0.375rem;
    background-color: rgba(0, 0, 0, 0.2);
    border-radius: 0.25rem;
    display: flex;
    align-items: center;
    justify-content: center;
  }

  .item-image img {
    max-width: 100%;
    max-height: 100%;
    object-fit: contain;
  }

  .selected-monsters {
    margin-top: 1rem;
    background-color: rgba(0, 0, 0, 0.1);
    border-radius: 0.5rem;
    padding: 1rem;
  }

  .selected-monsters-title {
    font-weight: bold;
    margin-bottom: 0.5rem;
  }

  .selected-monsters-list {
    display: flex;
    flex-wrap: wrap;
    gap: 0.5rem;
  }

  .selected-monster-tag {
    display: inline-flex;
    align-items: center;
    gap: 0.5rem;
    background-color: var(--nav-background);
    padding: 0.5rem;
    border-radius: 0.25rem;
  }

  .selected-monster-tag-remove {
    cursor: pointer;
    opacity: 0.7;
    transition: opacity 0.2s;
  }

  .selected-monster-tag-remove:hover {
    opacity: 1;
  }

  .trade-actions {
    display: flex;
    justify-content: center;
    margin-top: 2rem;
  }

  .btn-submit {
    background-color: var(--accent-color);
    color: white;
    padding: 0.75rem 2rem;
    border-radius: 0.5rem;
    font-size: 1.125rem;
    font-weight: bold;
    border: none;
    cursor: pointer;
    transition: background-color 0.3s ease;
    display: inline-flex;
    align-items: center;
    gap: 0.5rem;
  }

  .btn-submit:hover {
    background-color: var(--accent-hover-color);
  }

  @media (max-width: 768px) {
    .trade-grid {
      grid-template-columns: 1fr;
    }

    .trade-header {
      flex-direction: column;
      align-items: flex-start;
      gap: 1rem;
    }
  }
</style>

<script>
const selectedItems = {
  offered: {},
  requested: {}
};

// Validate trainer ID before making API call
async function loadTrainerInventory(trainerId, containerType) {
  // Clear existing inventory if trainer ID is invalid
  if (!trainerId || trainerId === '') {
    const container = document.getElementById(`${containerType}-items-container`);
    container.innerHTML = `
      <div class="empty-state">
        <div class="empty-state-icon">
          <i class="fas fa-user-slash"></i>
        </div>
        <div class="empty-state-text">Please select a trainer</div>
      </div>
    `;
    document.getElementById(`${containerType}-categories`).innerHTML = '';
    return;
  }

  try {
    const response = await fetch(`/api/trainers/${trainerId}/inventory`);
    if (!response.ok) {
      throw new Error(`HTTP error! status: ${response.status}`);
    }
    const data = await response.json();

    if (!data.inventory) {
      throw new Error('No inventory data received');
    }

    // Debug log to check the received data
    console.log(`Received inventory data for ${containerType}:`, data.inventory);

    // Update the inventory displays
    displayInventory(data.inventory, containerType);
  } catch (error) {
    console.error('Error loading inventory:', error);
    const container = document.getElementById(`${containerType}-items-container`);
    container.innerHTML = `
      <div class="empty-state">
        <div class="empty-state-icon">
          <i class="fas fa-exclamation-triangle"></i>
        </div>
        <div class="empty-state-text">Error loading inventory</div>
      </div>
    `;
  }
}

function displayInventory(inventory, containerType) {
  // Setup categories
  const categories = Object.keys(inventory).filter(cat =>
    inventory[cat] && Object.keys(inventory[cat]).length > 0
  );

  console.log(`Categories for ${containerType}:`, categories); // Debug log

  const categoriesContainer = document.getElementById(`${containerType}-categories`);
  if (!categoriesContainer) {
    console.error(`Categories container not found for ${containerType}`);
    return;
  }

  categoriesContainer.innerHTML = categories.map((category, index) => `
    <button type="button"
            class="category-btn ${index === 0 ? 'active' : ''}"
            onclick="switchCategory('${category}', '${containerType}', this)">
      ${formatCategoryName(category)}
    </button>
  `).join('');

  // Store inventory data
  window[`${containerType}Inventory`] = inventory;

  // Load first category if available
  if (categories.length > 0) {
    displayCategoryItems(categories[0], containerType);
  } else {
    const container = document.getElementById(`${containerType}-items-container`);
    if (container) {
      container.innerHTML = `
        <div class="empty-state">
          <div class="empty-state-icon">
            <i class="fas fa-box-open"></i>
          </div>
          <div class="empty-state-text">No items available</div>
        </div>
      `;
    }
  }
}

function formatCategoryName(category) {
  return category.replace('inv_', '').split('_')
    .map(word => word.charAt(0).toUpperCase() + word.slice(1))
    .join(' ');
}

function switchCategory(category, containerType, button) {
  // Update active button state
  const categoryButtons = button.parentElement.querySelectorAll('.category-btn');
  categoryButtons.forEach(btn => btn.classList.remove('active'));
  button.classList.add('active');

  // Display items for selected category
  displayCategoryItems(category, containerType);
}

function displayCategoryItems(category, containerType) {
  const inventory = window[`${containerType}Inventory`];
  const container = document.getElementById(`${containerType}-items-container`);

  if (!container) {
    console.error(`Items container not found for ${containerType}`);
    return;
  }

  const items = inventory[category];
  console.log(`Displaying items for ${containerType}, category ${category}:`, items); // Debug log

  if (!items || Object.keys(items).length === 0) {
    container.innerHTML = `
      <div class="empty-state">
        <div class="empty-state-icon">
          <i class="fas fa-box-open"></i>
        </div>
        <div class="empty-state-text">No items in this category</div>
      </div>
    `;
    return;
  }

  container.innerHTML = Object.entries(items).map(([itemName, quantity]) => `
    <div class="item-card" data-name="${itemName.toLowerCase()}" data-category="${category}">
      <div class="item-image">
        <img src="/images/items/${itemName.toLowerCase()}.png"
             alt="${itemName}"
             onerror="this.src='/images/items/default.png'">
      </div>
      <div class="item-details">
        <h3 class="item-name">${itemName}</h3>
        <p class="item-quantity">Quantity: ${quantity}</p>
        <div class="item-controls">
          <button type="button" class="quantity-btn" onclick="adjustQuantity(this, -1)">-</button>
          <input type="number"
                 class="quantity-input"
                 min="0"
                 max="${quantity}"
                 value="0"
                 onchange="validateQuantity(this, ${quantity})">
          <button type="button" class="quantity-btn" onclick="adjustQuantity(this, 1)">+</button>
        </div>
      </div>
    </div>
  `).join('');
}

// Event listeners for trainer selection
document.getElementById('yourTrainer').addEventListener('change', function(e) {
  const trainerId = e.target.value;
  if (trainerId && !isNaN(parseInt(trainerId)) && parseInt(trainerId) > 0) {
    loadTrainerInventory(trainerId, 'your');
  } else {
    // Clear the inventory if invalid trainer selected
    const container = document.getElementById('your-items-container');
    if (container) {
      container.innerHTML = '';
    }
  }
});

document.getElementById('tradePartner').addEventListener('change', function(e) {
  const trainerId = e.target.value;
  if (trainerId && !isNaN(parseInt(trainerId)) && parseInt(trainerId) > 0) {
    loadTrainerInventory(trainerId, 'their');
  } else {
    // Clear the inventory if invalid trainer selected
    const container = document.getElementById('their-items-container');
    if (container) {
      container.innerHTML = '';
    }
  }
});

// Initialize search functionality
document.querySelectorAll('.search-input').forEach(input => {
  input.addEventListener('input', function(e) {
    const containerType = this.id.includes('your') ? 'your' : 'their';
    const searchTerm = this.value.toLowerCase();
    const items = document.querySelectorAll(`#${containerType}-items-container .item-card`);

    items.forEach(item => {
      const itemName = item.dataset.name;
      item.style.display = itemName.includes(searchTerm) ? '' : 'none';
    });
  });
});

function adjustQuantity(button, change) {
  const input = button.parentElement.querySelector('.quantity-input');
  const currentValue = parseInt(input.value) || 0;
  const maxValue = parseInt(input.max);
  const newValue = Math.max(0, Math.min(currentValue + change, maxValue));
  input.value = newValue;
  input.dispatchEvent(new Event('change'));
}

function validateQuantity(input, max) {
  console.log('validateQuantity called with:', { input, max });

  let value = parseInt(input.value) || 0;
  value = Math.max(0, Math.min(value, max));
  input.value = value;

  const itemCard = input.closest('.item-card');
  console.log('itemCard:', itemCard);

  const itemName = itemCard.querySelector('.item-name').textContent;
  const category = itemCard.dataset.category;

  // Find the trade section by traversing up the DOM
  const tradeSection = itemCard.closest('.trade-section');
  console.log('tradeSection:', tradeSection);

  // Get the section title to determine if this is 'your' or 'their' section
  const sectionTitle = tradeSection.querySelector('.trade-section-title');
  if (!sectionTitle) {
    console.error('Could not find section title element');
    return;
  }

  const titleText = sectionTitle.textContent.trim();
  console.log('Section title:', titleText);

  // Check if this is 'your' or 'their' section
  let containerType = 'unknown';
  if (titleText.includes('Your Items')) {
    containerType = 'your';
  } else if (titleText.includes('Their Items')) {
    containerType = 'their';
  } else {
    // Fallback to checking the section's position in the DOM
    const sections = document.querySelectorAll('.trade-section');
    if (sections.length >= 2) {
      containerType = (tradeSection === sections[0]) ? 'your' : 'their';
    }
  }

  const itemType = containerType === 'your' ? 'offered' : 'requested';

  console.log('Updating items:', {
    containerType,
    itemType,
    itemName,
    category,
    value
  });

  updateSelectedItems(itemType, itemName, category, value);
}

function updateSelectedItems(type, itemName, category, quantity) {
  console.log('updateSelectedItems called with:', {
    type,
    itemName,
    category,
    quantity,
    currentSelectedItems: { ...selectedItems }
  });

  quantity = parseInt(quantity) || 0;

  if (!selectedItems[type]) {
    selectedItems[type] = {};
  }

  if (quantity > 0) {
    // Store both quantity and category
    selectedItems[type][itemName] = {
      quantity: quantity,
      category: category
    };
  } else {
    delete selectedItems[type][itemName];
  }

  console.log('selectedItems after update:', { ...selectedItems });
  updateSelectedItemsList(type);
  updateHiddenInputs(); // Update the hidden inputs for the form
  updateSubmitButton(); // Enable/disable submit button based on selection
}

function removeSelectedItem(type, itemName, category) {
  console.log(`Removing item: type=${type}, itemName=${itemName}, category=${category}`);

  // type should already be 'offered' or 'requested' here
  if (selectedItems[type] && selectedItems[type][itemName]) {
    delete selectedItems[type][itemName];

    // Map back to container type for DOM operations
    const containerType = type === 'offered' ? 'your' : 'their';
    const container = document.getElementById(`${containerType}-items-container`);

    if (container) {
      // Find the item card by name (case insensitive)
      const itemCards = container.querySelectorAll('.item-card');
      let itemCard = null;

      for (const card of itemCards) {
        const cardName = card.querySelector('.item-name').textContent;
        if (cardName.toLowerCase() === itemName.toLowerCase()) {
          itemCard = card;
          break;
        }
      }

      if (itemCard) {
        const input = itemCard.querySelector('.quantity-input');
        if (input) input.value = 0;
      }
    }
  }

  updateSelectedItemsList(type);
  updateHiddenInputs(); // Update the hidden inputs for the form
  updateSubmitButton(); // Update the submit button state
}

function updateSelectedItemsList(type) {
  // type should be 'offered' or 'requested'
  const listId = `${type}-items-list`;
  const listElement = document.getElementById(listId);
  if (!listElement) {
    console.error(`List element with ID ${listId} not found`);
    return;
  }

  console.log(`Updating ${type} items list with:`, selectedItems[type]);
  listElement.innerHTML = '';

  if (!selectedItems[type] || Object.keys(selectedItems[type]).length === 0) {
    // Show empty state
    const emptyState = document.createElement('div');
    emptyState.className = 'empty-state';
    emptyState.innerHTML = '<div class="empty-state-text">No items selected</div>';
    listElement.appendChild(emptyState);
    return;
  }

  Object.entries(selectedItems[type]).forEach(([itemName, itemData]) => {
    if (itemData && itemData.quantity > 0) {
      const itemElement = document.createElement('div');
      itemElement.className = 'selected-item';
      itemElement.innerHTML = `
        <span>${itemName} x${itemData.quantity}</span>
        <button type="button" onclick="removeSelectedItem('${type}', '${itemName}', '${itemData.category}')" class="remove-btn">
          <i class="fas fa-times"></i>
        </button>
      `;
      listElement.appendChild(itemElement);
    }
  });
}

// Update hidden inputs for form submission
function updateHiddenInputs() {
  // Clear previous inputs
  document.getElementById('offered-items-inputs').innerHTML = '';
  document.getElementById('requested-items-inputs').innerHTML = '';

  // Add offered items to the form
  Object.entries(selectedItems.offered).forEach(([itemName, itemData]) => {
    const input = document.createElement('input');
    input.type = 'hidden';
    input.name = 'offered_items[]';
    input.value = JSON.stringify({
      name: itemName,
      quantity: itemData.quantity,
      category: itemData.category
    });
    document.getElementById('offered-items-inputs').appendChild(input);
  });

  // Add requested items to the form
  Object.entries(selectedItems.requested).forEach(([itemName, itemData]) => {
    const input = document.createElement('input');
    input.type = 'hidden';
    input.name = 'requested_items[]';
    input.value = JSON.stringify({
      name: itemName,
      quantity: itemData.quantity,
      category: itemData.category
    });
    document.getElementById('requested-items-inputs').appendChild(input);
  });
}

// Update submit button state
function updateSubmitButton() {
  const submitButton = document.querySelector('.btn-submit');
  if (!submitButton) return;

  const hasOfferedItems = Object.keys(selectedItems.offered).length > 0;
  const hasRequestedItems = Object.keys(selectedItems.requested).length > 0;

  // Enable button if at least one item is selected
  submitButton.disabled = !(hasOfferedItems || hasRequestedItems);
}

// Form submission handler
document.getElementById('trade-form').addEventListener('submit', function(e) {
  e.preventDefault();

  // Validate trainer selections
  const initiatorId = document.getElementById('yourTrainer').value;
  const recipientId = document.getElementById('tradePartner').value;

  if (!initiatorId || !recipientId) {
    alert('Please select both traders');
    return;
  }

  // Set the trainer IDs
  document.getElementById('initiator_id').value = initiatorId;
  document.getElementById('recipient_id').value = recipientId;

  // Update hidden inputs one last time
  updateHiddenInputs();

  // Submit the form if we have at least one item selected
  if (Object.keys(selectedItems.offered).length > 0 || Object.keys(selectedItems.requested).length > 0) {
    console.log('Submitting trade form with:', {
      initiator_id: initiatorId,
      recipient_id: recipientId,
      offered_items: selectedItems.offered,
      requested_items: selectedItems.requested
    });
    this.submit();
  } else {
    alert('Please select at least one item to trade.');
  }
});
</script>

<style>
.item-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
  gap: 1rem;
  padding: 1rem;
}

.item-card {
  background: var(--card-background);
  border-radius: 0.5rem;
  padding: 1rem;
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
}

.item-image {
  width: 64px;
  height: 64px;
  margin: 0 auto;
}

.item-image img {
  width: 100%;
  height: 100%;
  object-fit: contain;
}

.item-details {
  text-align: center;
  margin-top: 0.5rem;
}

.item-name {
  font-weight: 600;
  margin-bottom: 0.25rem;
}

.item-quantity {
  color: var(--text-secondary);
  font-size: 0.875rem;
  margin-bottom: 0.5rem;
}

.item-controls {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 0.5rem;
}

.quantity-btn {
  background: var(--accent-color);
  color: white;
  border: none;
  border-radius: 0.25rem;
  width: 24px;
  height: 24px;
  cursor: pointer;
}

.quantity-input {
  width: 50px;
  text-align: center;
  border: 1px solid var(--divider-color);
  border-radius: 0.25rem;
  padding: 0.25rem;
}

.category-btn {
  background: var(--accent-color);
  color: white;
  border: none;
  padding: 0.5rem 1rem;
  border-radius: 0.25rem;
  cursor: pointer;
  margin-right: 0.5rem;
  margin-bottom: 0.5rem;
}

.category-btn:hover {
  opacity: 0.9;
}

.category-btn.active {
  background: var(--accent-color-dark);
}

.empty-state {
  text-align: center;
  padding: 2rem;
  color: var(--text-secondary);
}

.empty-state-icon {
  font-size: 2rem;
  margin-bottom: 1rem;
}

.selected-item {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 0.5rem;
  background: var(--card-background);
  border-radius: 0.25rem;
  margin-bottom: 0.5rem;
}

.remove-btn {
  background: none;
  border: none;
  color: var(--danger-color);
  cursor: pointer;
}

.selected-items-list {
  margin-top: 1rem;
  padding: 0.5rem;
  border: 1px solid var(--border-color);
  border-radius: 0.25rem;
  min-height: 50px;
}

.selected-item {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 0.25rem 0.5rem;
  background: var(--background-secondary);
  border-radius: 0.25rem;
  margin-bottom: 0.25rem;
}

.remove-btn {
  background: none;
  border: none;
  color: var(--danger-color);
  cursor: pointer;
  padding: 0.25rem;
}
</style>
