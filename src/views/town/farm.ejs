<div class="container mx-auto px-4 mt-6">

    <img src="https://i.imgur.com/fztdYkJ.png" alt="Farm Banner" class="location-banner w-full object-cover rounded-lg shadow-lg">
    <div class="absolute inset-0 bg-gradient-to-t from-black/90 to-transparent/30"></div>
    <div class="absolute inset-0 flex flex-col justify-end items-center pb-4">
      <h1 class="text-3xl font-display font-bold text-center mb-1 text-white text-shadow-xl">Farm</h1>
      <p class="text-center text-sm mb-2 max-w-2xl mx-auto text-gray-200">Welcome to the farm! There's always work to be done here, from feeding animals to tending crops.</p>

  </div>

  <div class="max-w-4xl mx-auto mt-8">
    <div class="bg-card rounded-lg p-6 shadow-lg">
      <h2 class="text-xl font-display font-bold mb-4">Farm Activities</h2>
      <p class="text-gray-300 mb-6">Choose an activity to perform on the farm:</p>

      <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
        <button id="work-farm" class="btn-primary text-center py-3 px-6 rounded-lg">
          <i class="fas fa-tractor mr-2"></i> Work Farm
        </button>
        <a href="/town/visit/farm/breed" class="btn-primary text-center py-3 px-6 rounded-lg inline-block">
          <i class="fas fa-paw mr-2"></i> Breed Monsters
        </a>
      </div>

      <script>
        document.addEventListener('DOMContentLoaded', function() {
          const workButton = document.getElementById('work-farm');

          workButton.addEventListener('click', async function() {
            try {
              // Disable the button to prevent multiple clicks
              workButton.disabled = true;
              workButton.innerHTML = '<i class="fas fa-spinner fa-spin mr-2"></i> Starting...';

              // Start the activity session
              const response = await fetch('/town/visit/start-activity', {
                method: 'POST',
                headers: {
                  'Content-Type': 'application/json'
                },
                body: JSON.stringify({
                  location: 'farm',
                  activity: 'work'
                })
              });

              const data = await response.json();

              if (data.success) {
                // Redirect to the activity session page
                window.location.href = data.redirect;
              } else {
                alert('Error starting activity: ' + data.message);
                workButton.disabled = false;
                workButton.innerHTML = '<i class="fas fa-tractor mr-2"></i> Work Farm';
              }
            } catch (error) {
              console.error('Error starting activity:', error);
              alert('Error starting activity. Please try again.');
              workButton.disabled = false;
              workButton.innerHTML = '<i class="fas fa-tractor mr-2"></i> Work Farm';
            }
          });
        });
      </script>
    </div>
  </div>
</div>

<style>
  .bg-card {
    background-color: var(--card-bg);
  }

  .btn-primary {
    background-color: var(--accent-color);
    color: var(--background-color);
    font-weight: 500;
    transition: all 0.2s;
  }

  .btn-primary:hover {
    background-color: var(--accent-hover);
    transform: translateY(-2px);
  }

  .text-shadow-xl {
    text-shadow: 0 4px 8px rgba(0, 0, 0, 0.8);
  }
</style>
