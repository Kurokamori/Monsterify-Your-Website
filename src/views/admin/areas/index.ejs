<% /* Set the title and other variables for the layout */ %>
<% title = 'Manage Areas' %>

<div class="container mx-auto px-4 py-6">
  <div class="flex justify-between items-center mb-6">
    <h1 class="text-2xl font-bold">Manage Areas</h1>
    <a href="/admin/areas/create" class="btn-primary">
      <i class="fas fa-plus mr-2"></i> Add New Area
    </a>
  </div>

  <!-- Message Display -->
  <% if (typeof message !== 'undefined' && message) { %>
    <div class="alert alert-<%= messageType || 'info' %> my-4">
      <%= message %>
    </div>
  <% } %>

  <!-- Areas Table -->
  <div class="bg-gray-900 border border-gray-800 rounded-lg shadow-lg overflow-hidden">
    <table class="min-w-full divide-y divide-gray-800">
      <thead class="bg-gray-800">
        <tr>
          <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider">ID</th>
          <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider">Name</th>
          <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider">Region</th>
          <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider">Description</th>
          <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider">Image</th>
          <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider">Difficulty</th>
          <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider">Status</th>
          <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider">Actions</th>
        </tr>
      </thead>
      <tbody class="bg-gray-900 divide-y divide-gray-800">
        <% if (areas && areas.length > 0) { %>
          <% areas.forEach(area => { %>
            <tr>
              <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-300"><%= area.area_id %></td>
              <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-300"><%= area.name %></td>
              <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-300"><%= area.region_name || 'Unknown' %></td>
              <td class="px-6 py-4 text-sm text-gray-300">
                <div class="max-w-xs truncate"><%= area.description || 'No description' %></div>
              </td>
              <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-300">
                <% if (area.image_url) { %>
                  <img src="<%= area.image_url %>" alt="<%= area.name %>" class="h-10 w-16 object-cover rounded">
                <% } else { %>
                  No image
                <% } %>
              </td>
              <td class="px-6 py-4 whitespace-nowrap text-sm">
                <%
                let difficultyColor = 'bg-blue-100 text-blue-800';
                if (area.difficulty === 'easy') {
                  difficultyColor = 'bg-green-100 text-green-800';
                } else if (area.difficulty === 'hard') {
                  difficultyColor = 'bg-orange-100 text-orange-800';
                } else if (area.difficulty === 'expert') {
                  difficultyColor = 'bg-red-100 text-red-800';
                }
                %>
                <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full <%= difficultyColor %>">
                  <%= area.difficulty ? area.difficulty.charAt(0).toUpperCase() + area.difficulty.slice(1) : 'Normal' %>
                </span>
              </td>
              <td class="px-6 py-4 whitespace-nowrap text-sm">
                <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full <%= area.is_active ? 'bg-green-100 text-green-800' : 'bg-red-100 text-red-800' %>">
                  <%= area.is_active ? 'Active' : 'Inactive' %>
                </span>
              </td>
              <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-300">
                <div class="flex space-x-2">
                  <a href="/admin/areas/edit/<%= area.area_id %>" class="text-indigo-400 hover:text-indigo-300">
                    <i class="fas fa-edit"></i> Edit
                  </a>
                  <form action="/admin/areas/delete/<%= area.area_id %>" method="POST" class="inline" onsubmit="return confirm('Are you sure you want to delete this area? This action cannot be undone.')">
                    <button type="submit" class="text-red-400 hover:text-red-300">
                      <i class="fas fa-trash"></i> Delete
                    </button>
                  </form>
                </div>
              </td>
            </tr>
          <% }); %>
        <% } else { %>
          <tr>
            <td colspan="7" class="px-6 py-4 text-center text-sm text-gray-400">
              No areas found. <a href="/admin/areas/create" class="text-indigo-400 hover:text-indigo-300">Create one</a>.
            </td>
          </tr>
        <% } %>
      </tbody>
    </table>
  </div>
</div>

<style>
  .btn-primary {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    padding: 0.5rem 1rem;
    font-weight: 500;
    color: white;
    background-color: #4f46e5;
    border-radius: 0.375rem;
    transition: background-color 0.2s;
    text-decoration: none;
  }

  .btn-primary:hover {
    background-color: #4338ca;
  }

  .alert {
    padding: 1rem;
    border-radius: 0.375rem;
    margin-bottom: 1rem;
  }

  .alert-success {
    background-color: rgba(16, 185, 129, 0.2);
    border: 1px solid rgba(16, 185, 129, 0.4);
    color: #10b981;
  }

  .alert-error {
    background-color: rgba(239, 68, 68, 0.2);
    border: 1px solid rgba(239, 68, 68, 0.4);
    color: #ef4444;
  }

  .alert-info {
    background-color: rgba(59, 130, 246, 0.2);
    border: 1px solid rgba(59, 130, 246, 0.4);
    color: #3b82f6;
  }
</style>
