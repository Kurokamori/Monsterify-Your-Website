<% /* Set the title and other variables for the layout */ %>
<% title = 'Add Monster' %>

<style>
.form-container {
    max-width: 1200px;
    margin: 0 auto;
    padding: 2rem;
    background: rgba(30, 37, 50, 0.5);
    border-radius: 16px;
    box-shadow: 0 8px 24px rgba(0, 0, 0, 0.15);
}

.form-title {
    text-align: center;
    margin-bottom: 2rem;
}

.form-section {
    margin-bottom: 2rem;
    padding: 1.5rem;
    background: rgba(0, 0, 0, 0.2);
    border-radius: 12px;
}

.form-section-title {
    font-size: 1.5rem;
    font-weight: 600;
    margin-bottom: 1.5rem;
    color: var(--accent-color, #d4b3ff);
    border-bottom: 1px solid rgba(255, 255, 255, 0.1);
    padding-bottom: 0.5rem;
}

.form-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
    gap: 1.5rem;
}

.form-group {
    margin-bottom: 1.5rem;
}

.form-group label {
    display: block;
    margin-bottom: 0.5rem;
    font-weight: 600;
}

.form-control {
    width: 100%;
    padding: 0.75rem;
    background: rgba(0, 0, 0, 0.2);
    border: 1px solid rgba(255, 255, 255, 0.1);
    border-radius: 8px;
    color: #fff;
    font-size: 1rem;
}

.form-control:focus {
    outline: none;
    border-color: var(--accent-color, #d4b3ff);
    box-shadow: 0 0 0 2px rgba(212, 179, 255, 0.2);
}

.form-control:disabled {
    opacity: 0.6;
    cursor: not-allowed;
}

.form-note {
    font-size: 0.85rem;
    color: rgba(255, 255, 255, 0.7);
    margin-top: 0.5rem;
}

.form-actions {
    display: flex;
    justify-content: space-between;
    margin-top: 2rem;
    gap: 1rem;
}

.btn {
    padding: 0.75rem 1.5rem;
    border: none;
    border-radius: 8px;
    font-size: 1rem;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.2s ease;
}

.btn-primary {
    background-color: var(--accent-color, #d4b3ff);
    color: #000;
}

.btn-primary:hover {
    background-color: #c49ef7;
}

.btn-secondary {
    background-color: rgba(255, 255, 255, 0.1);
    color: #fff;
}

.btn-secondary:hover {
    background-color: rgba(255, 255, 255, 0.2);
}

.monster-type {
    display: inline-block;
    padding: 0.25rem 0.5rem;
    border-radius: 4px;
    margin-right: 0.5rem;
    margin-bottom: 0.5rem;
    font-size: 0.9rem;
    font-weight: 600;
}

.monster-type.Normal { background-color: #A8A878; color: #fff; }
.monster-type.Fire { background-color: #F08030; color: #fff; }
.monster-type.Water { background-color: #6890F0; color: #fff; }
.monster-type.Electric { background-color: #F8D030; color: #000; }
.monster-type.Grass { background-color: #78C850; color: #fff; }
.monster-type.Ice { background-color: #98D8D8; color: #000; }
.monster-type.Fighting { background-color: #C03028; color: #fff; }
.monster-type.Poison { background-color: #A040A0; color: #fff; }
.monster-type.Ground { background-color: #E0C068; color: #000; }
.monster-type.Flying { background-color: #A890F0; color: #fff; }
.monster-type.Psychic { background-color: #F85888; color: #fff; }
.monster-type.Bug { background-color: #A8B820; color: #fff; }
.monster-type.Rock { background-color: #B8A038; color: #fff; }
.monster-type.Ghost { background-color: #705898; color: #fff; }
.monster-type.Dragon { background-color: #7038F8; color: #fff; }
.monster-type.Dark { background-color: #705848; color: #fff; }
.monster-type.Steel { background-color: #B8B8D0; color: #000; }
.monster-type.Fairy { background-color: #EE99AC; color: #000; }

.monster-attribute {
    display: inline-block;
    padding: 0.25rem 0.5rem;
    border-radius: 4px;
    margin-right: 0.5rem;
    margin-bottom: 0.5rem;
    font-size: 0.9rem;
    font-weight: 600;
}

.monster-attribute.Vaccine { background-color: #78C850; color: #fff; }
.monster-attribute.Variable { background-color: #F8D030; color: #000; }
.monster-attribute.Virus { background-color: #F08030; color: #fff; }
.monster-attribute.Data { background-color: #6890F0; color: #fff; }
.monster-attribute.Free { background-color: #A8A878; color: #fff; }

.checkbox-group {
    margin-top: 1rem;
}

.checkbox-label {
    display: flex;
    align-items: center;
    margin-bottom: 0.5rem;
    cursor: pointer;
}

.checkbox-input {
    margin-right: 0.5rem;
}

.tab-container {
    margin-bottom: 2rem;
}

.tab-buttons {
    display: flex;
    border-bottom: 1px solid rgba(255, 255, 255, 0.1);
    margin-bottom: 1.5rem;
}

.tab-button {
    padding: 0.75rem 1.5rem;
    background: none;
    border: none;
    color: #fff;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.2s ease;
    border-bottom: 3px solid transparent;
}

.tab-button.active {
    color: var(--accent-color, #d4b3ff);
    border-bottom-color: var(--accent-color, #d4b3ff);
}

.tab-content {
    display: none;
}

.tab-content.active {
    display: block;
}

@media (max-width: 768px) {
    .form-grid {
        grid-template-columns: 1fr;
    }

    .form-actions {
        flex-direction: column;
    }

    .btn {
        width: 100%;
    }
}
</style>

<div class="container mt-8 mb-12">
    <div class="form-container">
        <h1 class="form-title text-4xl font-display font-bold">Add Monster</h1>

        <form action="/admin/add-monster" method="POST">
            <div class="tab-container">
                <div class="tab-buttons">
                    <button type="button" class="tab-button active" data-tab="basic-info">Basic Info</button>
                    <button type="button" class="tab-button" data-tab="stats">Stats</button>
                    <button type="button" class="tab-button" data-tab="moves">Moves</button>
                    <button type="button" class="tab-button" data-tab="appearance">Appearance</button>
                    <button type="button" class="tab-button" data-tab="additional">Additional Info</button>
                </div>

                <!-- Basic Info Tab -->
                <div id="basic-info" class="tab-content active">
                    <div class="form-section">
                        <h2 class="form-section-title">Basic Information</h2>
                        
                        <div class="form-group">
                            <label for="trainer_id">Trainer</label>
                            <select id="trainer_id" name="trainer_id" class="form-control" required>
                                <option value="">Select a Trainer</option>
                                <% trainers.forEach(trainer => { %>
                                    <option value="<%= trainer.id %>"><%= trainer.name %> (<%= trainer.player_display_name %>)</option>
                                <% }); %>
                            </select>
                        </div>

                        <div class="form-group">
                            <label for="name">Monster Name</label>
                            <input type="text" id="name" name="name" class="form-control" required>
                        </div>

                        <div class="form-group">
                            <label for="level">Level</label>
                            <input type="number" id="level" name="level" class="form-control" value="1" min="1" max="100" required>
                        </div>

                        <div class="form-grid">
                            <div class="form-group">
                                <label for="species1">Primary Species</label>
                                <input type="text" id="species1" name="species1" class="form-control" required>
                            </div>

                            <div class="form-group">
                                <label for="species2">Secondary Species</label>
                                <input type="text" id="species2" name="species2" class="form-control">
                            </div>

                            <div class="form-group">
                                <label for="species3">Tertiary Species</label>
                                <input type="text" id="species3" name="species3" class="form-control">
                            </div>
                        </div>

                        <div class="form-grid">
                            <div class="form-group">
                                <label for="type1">Type 1</label>
                                <input type="text" id="type1" name="type1" class="form-control" required>
                            </div>

                            <div class="form-group">
                                <label for="type2">Type 2</label>
                                <input type="text" id="type2" name="type2" class="form-control">
                            </div>

                            <div class="form-group">
                                <label for="type3">Type 3</label>
                                <input type="text" id="type3" name="type3" class="form-control">
                            </div>
                        </div>

                        <div class="form-grid">
                            <div class="form-group">
                                <label for="type4">Type 4</label>
                                <input type="text" id="type4" name="type4" class="form-control">
                            </div>

                            <div class="form-group">
                                <label for="type5">Type 5</label>
                                <input type="text" id="type5" name="type5" class="form-control">
                            </div>

                            <div class="form-group">
                                <label for="attribute">Attribute</label>
                                <select id="attribute" name="attribute" class="form-control">
                                    <option value="">None</option>
                                    <option value="Vaccine">Vaccine</option>
                                    <option value="Variable">Variable</option>
                                    <option value="Virus">Virus</option>
                                    <option value="Data">Data</option>
                                    <option value="Free">Free</option>
                                </select>
                            </div>
                        </div>

                        <div class="form-group">
                            <label for="box_number">Box Number</label>
                            <input type="number" id="box_number" name="box_number" class="form-control" value="1" min="1">
                            <p class="form-note">Box 1 is the Battle Box. Leave at 1 if unsure.</p>
                        </div>
                    </div>
                </div>

                <!-- Stats Tab -->
                <div id="stats" class="tab-content">
                    <div class="form-section">
                        <h2 class="form-section-title">Stats</h2>
                        <p class="form-note mb-4">By default, stats will be automatically generated based on the monster's level. Check the box below to manually set stats.</p>

                        <div class="checkbox-group">
                            <label class="checkbox-label">
                                <input type="checkbox" id="manual_stats" class="checkbox-input">
                                Manually set stats
                            </label>
                        </div>

                        <div id="stats_container" class="form-grid mt-4" style="display: none;">
                            <!-- HP Stats -->
                            <div class="form-group">
                                <label for="hp_total">HP Total</label>
                                <input type="number" id="hp_total" name="hp_total" class="form-control" min="1">
                            </div>
                            <div class="form-group">
                                <label for="hp_iv">HP IV</label>
                                <input type="number" id="hp_iv" name="hp_iv" class="form-control" min="0" max="31">
                            </div>
                            <div class="form-group">
                                <label for="hp_ev">HP EV</label>
                                <input type="number" id="hp_ev" name="hp_ev" class="form-control" min="0" max="255" value="0">
                            </div>

                            <!-- Attack Stats -->
                            <div class="form-group">
                                <label for="atk_total">Attack Total</label>
                                <input type="number" id="atk_total" name="atk_total" class="form-control" min="1">
                            </div>
                            <div class="form-group">
                                <label for="atk_iv">Attack IV</label>
                                <input type="number" id="atk_iv" name="atk_iv" class="form-control" min="0" max="31">
                            </div>
                            <div class="form-group">
                                <label for="atk_ev">Attack EV</label>
                                <input type="number" id="atk_ev" name="atk_ev" class="form-control" min="0" max="255" value="0">
                            </div>

                            <!-- Defense Stats -->
                            <div class="form-group">
                                <label for="def_total">Defense Total</label>
                                <input type="number" id="def_total" name="def_total" class="form-control" min="1">
                            </div>
                            <div class="form-group">
                                <label for="def_iv">Defense IV</label>
                                <input type="number" id="def_iv" name="def_iv" class="form-control" min="0" max="31">
                            </div>
                            <div class="form-group">
                                <label for="def_ev">Defense EV</label>
                                <input type="number" id="def_ev" name="def_ev" class="form-control" min="0" max="255" value="0">
                            </div>

                            <!-- Special Attack Stats -->
                            <div class="form-group">
                                <label for="spa_total">Sp. Attack Total</label>
                                <input type="number" id="spa_total" name="spa_total" class="form-control" min="1">
                            </div>
                            <div class="form-group">
                                <label for="spa_iv">Sp. Attack IV</label>
                                <input type="number" id="spa_iv" name="spa_iv" class="form-control" min="0" max="31">
                            </div>
                            <div class="form-group">
                                <label for="spa_ev">Sp. Attack EV</label>
                                <input type="number" id="spa_ev" name="spa_ev" class="form-control" min="0" max="255" value="0">
                            </div>

                            <!-- Special Defense Stats -->
                            <div class="form-group">
                                <label for="spd_total">Sp. Defense Total</label>
                                <input type="number" id="spd_total" name="spd_total" class="form-control" min="1">
                            </div>
                            <div class="form-group">
                                <label for="spd_iv">Sp. Defense IV</label>
                                <input type="number" id="spd_iv" name="spd_iv" class="form-control" min="0" max="31">
                            </div>
                            <div class="form-group">
                                <label for="spd_ev">Sp. Defense EV</label>
                                <input type="number" id="spd_ev" name="spd_ev" class="form-control" min="0" max="255" value="0">
                            </div>

                            <!-- Speed Stats -->
                            <div class="form-group">
                                <label for="spe_total">Speed Total</label>
                                <input type="number" id="spe_total" name="spe_total" class="form-control" min="1">
                            </div>
                            <div class="form-group">
                                <label for="spe_iv">Speed IV</label>
                                <input type="number" id="spe_iv" name="spe_iv" class="form-control" min="0" max="31">
                            </div>
                            <div class="form-group">
                                <label for="spe_ev">Speed EV</label>
                                <input type="number" id="spe_ev" name="spe_ev" class="form-control" min="0" max="255" value="0">
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Moves Tab -->
                <div id="moves" class="tab-content">
                    <div class="form-section">
                        <h2 class="form-section-title">Moves</h2>
                        <p class="form-note mb-4">By default, moves will be automatically generated based on the monster's type and level. Check the box below to manually set moves.</p>

                        <div class="checkbox-group">
                            <label class="checkbox-label">
                                <input type="checkbox" id="manual_moves" class="checkbox-input">
                                Manually set moves
                            </label>
                        </div>

                        <div id="moves_container" class="form-grid mt-4" style="display: none;">
                            <div class="form-group">
                                <label for="move1">Move 1</label>
                                <input type="text" id="move1" name="moves[]" class="form-control">
                            </div>
                            <div class="form-group">
                                <label for="move2">Move 2</label>
                                <input type="text" id="move2" name="moves[]" class="form-control">
                            </div>
                            <div class="form-group">
                                <label for="move3">Move 3</label>
                                <input type="text" id="move3" name="moves[]" class="form-control">
                            </div>
                            <div class="form-group">
                                <label for="move4">Move 4</label>
                                <input type="text" id="move4" name="moves[]" class="form-control">
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Appearance Tab -->
                <div id="appearance" class="tab-content">
                    <div class="form-section">
                        <h2 class="form-section-title">Appearance</h2>

                        <div class="form-group">
                            <label for="img_link">Image URL</label>
                            <input type="text" id="img_link" name="img_link" class="form-control" placeholder="https://example.com/image.jpg">
                            <p class="form-note">Direct link to an image. Leave blank for default.</p>
                        </div>

                        <div class="form-grid">
                            <div class="form-group">
                                <label for="gender">Gender</label>
                                <select id="gender" name="gender" class="form-control">
                                    <option value="">Auto-generate</option>
                                    <option value="Male">Male</option>
                                    <option value="Female">Female</option>
                                    <option value="Non-binary">Non-binary</option>
                                    <option value="Genderless">Genderless</option>
                                </select>
                            </div>

                            <div class="form-group">
                                <label for="pronouns">Pronouns</label>
                                <input type="text" id="pronouns" name="pronouns" class="form-control" placeholder="e.g., he/him, she/her, they/them">
                            </div>

                            <div class="form-group">
                                <label for="height">Height</label>
                                <input type="text" id="height" name="height" class="form-control" placeholder="e.g., 5'7&quot;, 1.7m">
                            </div>
                        </div>

                        <div class="form-grid">
                            <div class="form-group">
                                <label for="nature">Nature</label>
                                <select id="nature" name="nature" class="form-control">
                                    <option value="">Auto-generate</option>
                                    <option value="Hardy">Hardy</option>
                                    <option value="Lonely">Lonely</option>
                                    <option value="Brave">Brave</option>
                                    <option value="Adamant">Adamant</option>
                                    <option value="Naughty">Naughty</option>
                                    <option value="Bold">Bold</option>
                                    <option value="Docile">Docile</option>
                                    <option value="Relaxed">Relaxed</option>
                                    <option value="Impish">Impish</option>
                                    <option value="Lax">Lax</option>
                                    <option value="Timid">Timid</option>
                                    <option value="Hasty">Hasty</option>
                                    <option value="Serious">Serious</option>
                                    <option value="Jolly">Jolly</option>
                                    <option value="Naive">Naive</option>
                                    <option value="Modest">Modest</option>
                                    <option value="Mild">Mild</option>
                                    <option value="Quiet">Quiet</option>
                                    <option value="Bashful">Bashful</option>
                                    <option value="Rash">Rash</option>
                                    <option value="Calm">Calm</option>
                                    <option value="Gentle">Gentle</option>
                                    <option value="Sassy">Sassy</option>
                                    <option value="Careful">Careful</option>
                                    <option value="Quirky">Quirky</option>
                                </select>
                            </div>

                            <div class="form-group">
                                <label for="characteristic">Characteristic</label>
                                <input type="text" id="characteristic" name="characteristic" class="form-control" placeholder="e.g., Proud of its power">
                                <p class="form-note">Leave blank to auto-generate</p>
                            </div>
                        </div>

                        <div class="form-grid">
                            <div class="form-group">
                                <label for="shiny">Shiny</label>
                                <select id="shiny" name="shiny" class="form-control">
                                    <option value="0">No</option>
                                    <option value="1">Yes</option>
                                </select>
                            </div>

                            <div class="form-group">
                                <label for="alpha">Alpha</label>
                                <select id="alpha" name="alpha" class="form-control">
                                    <option value="0">No</option>
                                    <option value="1">Yes</option>
                                </select>
                            </div>

                            <div class="form-group">
                                <label for="shadow">Shadow</label>
                                <select id="shadow" name="shadow" class="form-control">
                                    <option value="0">No</option>
                                    <option value="1">Yes</option>
                                </select>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Additional Info Tab -->
                <div id="additional" class="tab-content">
                    <div class="form-section">
                        <h2 class="form-section-title">Additional Information</h2>

                        <div class="form-grid">
                            <div class="form-group">
                                <label for="friendship">Friendship</label>
                                <input type="number" id="friendship" name="friendship" class="form-control" value="70" min="0" max="255">
                            </div>

                            <div class="form-group">
                                <label for="fav_berry">Favorite Berry</label>
                                <input type="text" id="fav_berry" name="fav_berry" class="form-control">
                            </div>

                            <div class="form-group">
                                <label for="held_item">Held Item</label>
                                <input type="text" id="held_item" name="held_item" class="form-control">
                            </div>
                        </div>

                        <div class="form-grid">
                            <div class="form-group">
                                <label for="seal">Seal</label>
                                <input type="text" id="seal" name="seal" class="form-control">
                            </div>

                            <div class="form-group">
                                <label for="mark">Mark</label>
                                <input type="text" id="mark" name="mark" class="form-control">
                            </div>

                            <div class="form-group">
                                <label for="poke_ball">Pok√© Ball</label>
                                <input type="text" id="poke_ball" name="poke_ball" class="form-control">
                            </div>
                        </div>

                        <div class="form-grid">
                            <div class="form-group">
                                <label for="date_met">Date Met</label>
                                <input type="date" id="date_met" name="date_met" class="form-control">
                                <p class="form-note">Leave blank for today's date</p>
                            </div>

                            <div class="form-group">
                                <label for="where_met">Where Met</label>
                                <input type="text" id="where_met" name="where_met" class="form-control">
                            </div>

                            <div class="form-group">
                                <label for="acquired">How Acquired</label>
                                <input type="text" id="acquired" name="acquired" class="form-control" placeholder="e.g., Gift, Caught, Hatched">
                            </div>
                        </div>

                        <div class="form-group">
                            <label for="talk">Catchphrase</label>
                            <input type="text" id="talk" name="talk" class="form-control" placeholder="A phrase this monster likes to say">
                        </div>

                        <div class="form-group">
                            <label for="tldr">TL;DR</label>
                            <textarea id="tldr" name="tldr" class="form-control" rows="2" placeholder="A brief summary of this monster's character"></textarea>
                        </div>

                        <div class="form-group">
                            <label for="bio">Biography</label>
                            <textarea id="bio" name="bio" class="form-control" rows="5" placeholder="A detailed biography for this monster"></textarea>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Form Actions -->
            <div class="form-actions">
                <a href="/admin/dashboard" class="btn btn-secondary">Cancel</a>
                <button type="submit" class="btn btn-primary">Create Monster</button>
            </div>
        </form>
    </div>
</div>

<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Tab switching
        const tabButtons = document.querySelectorAll('.tab-button');
        const tabContents = document.querySelectorAll('.tab-content');

        tabButtons.forEach(button => {
            button.addEventListener('click', function() {
                const tabId = this.getAttribute('data-tab');
                
                // Remove active class from all buttons and contents
                tabButtons.forEach(btn => btn.classList.remove('active'));
                tabContents.forEach(content => content.classList.remove('active'));
                
                // Add active class to current button and content
                this.classList.add('active');
                document.getElementById(tabId).classList.add('active');
            });
        });

        // Manual stats toggle
        const manualStatsCheckbox = document.getElementById('manual_stats');
        const statsContainer = document.getElementById('stats_container');

        manualStatsCheckbox.addEventListener('change', function() {
            statsContainer.style.display = this.checked ? 'grid' : 'none';
        });

        // Manual moves toggle
        const manualMovesCheckbox = document.getElementById('manual_moves');
        const movesContainer = document.getElementById('moves_container');

        manualMovesCheckbox.addEventListener('change', function() {
            movesContainer.style.display = this.checked ? 'grid' : 'none';
        });
    });
</script>
