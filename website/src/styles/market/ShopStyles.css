/* ====================================================================== */
/* SHOP — CONSOLIDATED CORE                                               */
/* ====================================================================== */

/* ---- Containers ---- */
.shop-page,
.shop-manager,
.shop-items-container,
.shop-form-container,
.faction-store{
  max-width: var(--container-max-width);
  margin:0 auto;
  padding:20px;
}

/* ---- Hero / headers ---- */
.shop-header {
  position: relative;
  height: 200px;
  border-radius: var(--radius);
  overflow: hidden;
  margin-bottom: 1rem;
  background: var(--card-background) center/cover no-repeat;
  text-align: center;
}

.shop-header::before{content:"";position:absolute;inset:0;background:var(--overlay-dark);}
.shop-header-content {
  position: relative;
  z-index: 1;
  height: 100%;
  display: flex;
  flex-direction: column;
  justify-content: center;
  padding: 20px;
  color: var(--text-color);
}

.shop-title {
  font-size: 2.5rem;
  margin: 0 0 10px 0;
  text-shadow: 2px 2px 4px var(--overlay-dark);
}

.shop-description {
  font-size: 1.1rem;
  max-width: 800px;
  text-shadow: 1px 1px 2px var(--overlay-heavy);
  color: var(--text-color);
  opacity: .8;
  margin: 0 auto;
}

.shop-flavor-text {
  background: var(--card-background);
  padding: 15px;
  border-radius: var(--radius);
  margin-bottom: 20px;
  font-style: italic;
  color: var(--accent-color);
  text-align: center;
}

/* ---- Controls / search ---- */
.shop-controls {
  display: flex;
  flex-direction: column;
  gap: 30px;
  margin-bottom: 20px;
  padding: 15px;
  background: var(--card-background);
  border-radius: var(--radius);
}

.trainer-currency {
  display: flex;
  align-items: center;
  gap: 8px;
  height: 100%;
}

.currency-amount {
  font-weight: 700;
  color: var(--accent-color-2);
  font-size: 1.3rem;
  text-shadow: 1px 1px 3px var(--overlay-heavy);
}

.shop-search {
  width: 100%;
  display: flex;
  gap: 10px;
  align-items: center;
}

.search-input {
  flex: 1;
  padding: 10px 15px;
  border: 1px solid var(--border-color);
  border-radius: var(--radius-sm);
  background: var(--card-background);
  color: var(--text-color);
  font-size: 1rem;
}

.search-input:focus {
  outline: none;
  border-color: var(--accent-color);
}

/* Button styles: Use unified button system from common/buttons.css
   Example: className="button secondary" or className="button toggle active" */

.sort-indicator {
  font-size: 1.1rem;
  font-weight: bold;
}

/* ---- Grids ---- */
.shop-items-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
  gap: 1.5rem;
}

@media (max-width:1400px){.shop-items-grid{grid-template-columns:repeat(4,1fr);}}
@media (max-width:1024px){.shop-items-grid{grid-template-columns:repeat(3,1fr);}}
@media (max-width:768px){ .shop-items-grid{grid-template-columns:repeat(2,1fr);} }
@media (max-width:480px){ .shop-items-grid{grid-template-columns:1fr;} }

/* ---- Empty / info blocks ---- */
.no-items-message,
.no-items{
  text-align:center; padding:40px; border-radius:var(--radius);
  color:var(--text-muted); background:var(--card-background);
}

/* ====================================================================== */
/* SHOP MANAGER + LISTS                                                   */
/* ====================================================================== */

.shop-manager-header,
.shop-items-header{
  display:flex; justify-content:space-between; align-items:center; gap:15px; margin-bottom:20px;
}
.shop-manager-header h1,
.shop-items-header h1,
.shop-form-header h1{margin:0;color:var(--text-color);}

/* Shop action buttons: Use unified button system from common/buttons.css
   Example: className="button success" for add, className="button icon info" for edit, etc. */

/* Manager cards & tables */
.shop-manager-content,
.shop-items-list,
.shop-stock-section,
.shop-form{ background:var(--card-background); border-radius:var(--radius); overflow:hidden; }

.shops-table-container,
.items-table-container{ overflow-x:auto; }

.shops-table,
.items-table{
  width:100%; border-collapse:collapse;
}
.shops-table th, .shops-table td,
.items-table th, .items-table td{
  padding:12px 15px; text-align:left; border-bottom:1px solid var(--border-color);
}
.shops-table th, .items-table th{
  background:var(--nav-background); color:var(--text-color); font-weight:700;
}
.shops-table tr:hover,
.items-table tr:hover{ background:var(--card-background-2); }
.inactive-shop {
  opacity: .7;
}

.shop-status {
  display: inline-block;
  padding: 4px 8px;
  border-radius: var(--radius-sm);
  font-size: .8rem;
  font-weight: 700;
}

.shop-status.active{ background:var(--success-glow); color:var(--success-color); }
.shop-status.inactive{ background:var(--error-glow); color:var(--error-color); }

.item-image-cell {
  width: 60px;
}

/* Quantity controls (tables & modals share) */
.quantity-control,
.quantity-input-group{ display:flex; align-items:center; gap:5px; }

/* Quantity buttons: Use unified button system - className="button quantity" */
.quantity-value {
  min-width: 30px;
  text-align: center;
}

/* Responsive trims for tables */
@media (max-width:768px){
  .shop-manager-header{ flex-direction:column; align-items:flex-start; gap:15px; }
  .shops-table th:nth-child(3), .shops-table td:nth-child(3),
  .shops-table th:nth-child(4), .shops-table td:nth-child(4),
  .items-table th:nth-child(3), .items-table td:nth-child(3),
  .items-table th:nth-child(4), .items-table td:nth-child(4){ display:none; }
  .shop-items-content{ grid-template-columns:1fr; }
}

/* ====================================================================== */
/* SHOP ITEMS — GRID CARDS (token-based section you already had)          */
/* ====================================================================== */

.shop-container {
  display: flex;
  flex-direction: column;
  gap: 1.5rem;
}

.shop-header h2{ font-size:var(--font-size-2xl); color:var(--accent-color); margin-bottom:.5rem; }

.shop-categories {
  display: flex;
  flex-wrap: wrap;
  gap: 1rem;
  justify-content: center;
  margin-bottom: 1.5rem;
  overflow-x: auto;
  padding-bottom: 0.5rem;
}

/* Category buttons: Use unified button system - className="button filter" or className="button filter active" */

/* item cards */
.shop-item {
  background: var(--card-background);
  border-radius: .5rem;
  overflow: hidden;
  box-shadow: 0 2px 4px var(--overlay-light);
  transition: transform var(--ease), box-shadow var(--ease);
  cursor: pointer;
}

.shop-item:hover:not(.out-of-stock){ transform:translateY(-4px); box-shadow:0 4px 8px var(--overlay-light); }
.shop-item.out-of-stock{ opacity:.6; cursor:not-allowed; }

.limited-badge {
  position: absolute;
  top: .5rem;
  right: .5rem;
  background: var(--accent-color);
  color: var(--text-color);
  font-size: var(--font-size-xs);
  font-weight: 600;
  padding: .25rem .5rem;
  border-radius: 1rem;
}

.item-info {
  padding: 1rem;
  display: flex;
  flex-direction: column;
  gap: .5rem;
}

.item-price {
  display: flex;
  align-items: center;
  gap: .75rem;
  color: var(--accent-light);
  font-weight: 700;
  font-size: 1.3rem;
  text-shadow: 1px 1px 3px var(--overlay-heavy);
}

.out-of-stock-label {
  font-size: var(--font-size-sm);
  color: var(--error-color);
  font-weight: 600;
}

.stock-label {
  font-size: var(--font-size-sm);
  color: var(--text-color);
  opacity: .8;
}

/* Pagination */
.shop-pagination {
  display: flex;
  justify-content: center;
  align-items: center;
  gap: 1rem;
  margin-top: 1.5rem;
}

/* Item modal (token-based) */
.item-modal-content {
  display: flex;
  flex-direction: column;
  gap: 1.5rem;
}

@media (min-width:768px){ .item-details{ flex-direction:row; } }
.item-image-large-container {
  width: 100%;
  display: flex;
  align-items: center;
  justify-content: center;
  background: var(--card-background-light);
  border-radius: .5rem;
  padding: 1.5rem;
}

@media (min-width:768px){ .item-image-large-container{ width:40%; } }
.item-image-large {
  max-width: 100%;
  max-height: 200px;
  object-fit: contain;
}

.item-info-detailed {
  flex: 1;
  display: flex;
  flex-direction: column;
  gap: 1rem;
}

.meta-item {
  display: flex;
  justify-content: space-between;
}

/* Purchase section (token-based) */
.purchase-section {
  border-top: 1px solid var(--divider-color);
  padding-top: 1.5rem;
  display: flex;
  flex-direction: column;
  gap: 1.5rem;
}

@media (min-width:768px){ .purchase-section{ flex-direction:row; } }
.purchase-options {
  display: flex;
  flex-direction: column;
  gap: 1rem;
  flex: 1;
}

.quantity-input {
  display: flex;
  align-items: center;
  width: 60px;
  padding: 0.25rem;
  border: 1px solid var(--divider-color);
  border-radius: 4px;
  text-align: center;
  background: var(--input-background);
  color: var(--text-color);
}

.quantity-input input{
  width:3rem; height:2rem; text-align:center; border:1px solid var(--border-color);
  border-left:none; border-right:none; background:var(--input-background); color:var(--text-color);
}
.form-group select{
  padding:.5rem; border-radius:.25rem; border:1px solid var(--border-color);
  background:var(--input-background); color:var(--text-color);
}
.purchase-summary {
  display: flex;
  flex-direction: column;
  gap: 1rem;
  flex: 1;
  padding: 1rem;
  background: var(--card-background-light);
  border-radius: .5rem;
}

.total-price {
  display: flex;
  justify-content: space-between;
  font-weight: 600;
  font-size: var(--font-size-lg);
}

.total-value {
  color: var(--accent-color);
  display: flex;
  align-items: center;
  gap: .25rem;
}

.trainer-balance {
  display: flex;
  justify-content: space-between;
  font-size: var(--font-size-base);
}

.purchase-error {
  color: var(--text-color);
  text-align: center;
  padding: .5rem;
  background: var(--error-color);
  border-radius: .25rem;
  font-size: var(--font-size-sm);
}

/* Purchase buttons: Use unified button system - className="button primary lg block" */

/* Login prompt */
.login-prompt {
  text-align: center;
  padding: 2rem;
  background: var(--card-background-light);
  border-radius: 0.5rem;
  background-color: var(--card-background);
  box-shadow: 0 2px 4px var(--overlay-light);
}

/* Modal buttons (token-based) */

/* Modal buttons: Use unified button system - className="button primary" or className="button secondary" */
@media (max-width:768px){ .modal-actions{ flex-direction:column; } }

/* ====================================================================== */
/* FACTION STORE (kept fancy; minor grouping)                             */
/* ====================================================================== */

.faction-store {
  position: relative;
}

.store-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  gap: 1.5rem;
  margin-bottom: 2.5rem;
  padding: 2rem;
  border-radius: var(--radius-xl);
  position: relative;
  overflow: hidden;
  background: linear-gradient(135deg, var(--overlay-solid) 0%, var(--overlay-heavy) 100%);
  border-left: 4px solid var(--accent-color);
  border: 1px solid var(--accent-glow);
  backdrop-filter: blur(20px);
}

.store-header::before{
  content:""; position:absolute; inset:0;
  background:linear-gradient(135deg, var(--accent-glow-subtle) 0%, transparent 50%); pointer-events:none;
}
.store-header h3{ color:var(--accent-color); margin:0; font-size:1.8rem; font-weight:700; position:relative; z-index:1; }

.trainer-currency {
  display: flex;
  align-items: center;
  gap: .75rem;
  padding: 1rem 1.5rem;
  border-radius: 12px;
  background: linear-gradient(135deg, var(--accent-glow-soft) 0%, var(--accent-glow-faint) 100%);
  border: 2px solid var(--accent-glow-strong);
  backdrop-filter: blur(10px);
  transition: all .3s ease;
  position: relative;
  z-index: 1;
}

.trainer-currency:hover{ border-color:var(--accent-color); box-shadow:0 4px 15px var(--accent-glow); }
.currency-label {
  color: var(--text-color);
  font-weight: 600;
}

.currency-amount i{ color:var(--accent-color); margin-left:.5rem; font-size:1.2rem; filter:drop-shadow(1px 1px 2px var(--overlay-dark)); }

/* Alerts (base) */
.purchase-success,
.purchase-error{
  padding:1.25rem; border-radius:12px; margin-bottom:1.5rem; display:flex; align-items:center; gap:.75rem; font-weight:500;
}
/* Faction-flavored overrides */
.faction-store .purchase-success{
  background:linear-gradient(135deg, var(--success-glow) 0%, var(--success-glow) 100%);
  border:2px solid var(--success-glow-medium); color:var(--success-light); backdrop-filter:blur(10px); box-shadow:0 4px 15px var(--success-glow);
}
.faction-store .purchase-error{
  background:linear-gradient(135deg, var(--error-glow) 0%, var(--error-glow) 100%);
  border:2px solid var(--error-glow); color:var(--error-color); backdrop-filter:blur(10px); box-shadow:0 4px 15px var(--error-glow);
}
/* Dismiss buttons: Use unified button system - className="button close" */

.no-items {
  background: linear-gradient(135deg, var(--overlay-heavy) 0%, var(--overlay-dark) 100%);
  border: 1px solid var(--accent-glow);
  color: var(--text-color);
  border-radius: 16px;
  backdrop-filter: blur(15px);
}

/* Store grid + cards */
.store-items-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(320px,1fr));
  gap: 2rem;
  margin-bottom: 3rem;
}

.store-item-card {
  position: relative;
  overflow: hidden;
  height: 100%;
  display: flex;
  flex-direction: column;
  gap: 0;
  padding: 2rem;
  border-radius: 16px;
  backdrop-filter: blur(20px);
  background: linear-gradient(135deg, var(--overlay-solid) 0%, var(--overlay-heavy) 100%);
  border: 2px solid var(--accent-glow);
  transition: all .4s ease;
}

.store-item-card::before{
  content:""; position:absolute; inset:0;
  background:linear-gradient(135deg, var(--accent-glow) 0%, transparent 50%); opacity:0; transition:opacity .4s ease;
}
.store-item-card:hover{
  transform:translateY(-8px) scale(1.02); box-shadow:0 12px 30px var(--overlay-heavy); border-color:var(--accent-color);
}
.store-item-card:hover::before{ opacity:1; }

/* Scoped item internals to avoid global clashes */
.store-item-card .item-header{ display:flex; align-items:center; gap:1.25rem; margin-bottom:1.5rem; position:relative; z-index:1; }

.store-item-card:hover .item-icon{ border-color:var(--accent-color); box-shadow:0 4px 15px var(--accent-glow-medium); }
.store-item-card .item-info{ flex:1; position:relative; z-index:1; }
.store-item-card .item-name{ color:var(--text-color); margin:0 0 .5rem 0; font-size:1.3rem; font-weight:700; text-shadow:1px 1px 3px var(--overlay-heavy); }
.item-type {
  color: var(--text-color);
  font-size: .95rem;
  font-weight: 500;
  text-transform: capitalize;
  background: linear-gradient(135deg, var(--highlight-light) 0%, var(--highlight-light) 100%);
  padding: .4rem .8rem;
  border-radius: 8px;
  border: 1px solid var(--highlight-light);
  backdrop-filter: blur(5px);
}

.store-item-card .item-description{ color:var(--text-color); line-height:1.6; margin-bottom:1.5rem; flex:1; font-size:1.05rem; position:relative; z-index:1; }
.store-item-card .item-details{ display:flex; flex-direction:column; gap:.75rem; margin-bottom:1.5rem; position:relative; z-index:1; }

.price-amount {
  font-size: 1.4rem;
  filter: drop-shadow(1px 1px 2px var(--overlay-dark));
}

.standing-requirement {
  color: var(--warning-color);
  font-size: .95rem;
  font-weight: 500;
  padding: .5rem .75rem;
  border-radius: 8px;
  background: linear-gradient(135deg, var(--warning-glow) 0%, var(--warning-glow) 100%);
  border-left: 3px solid var(--warning-color);
  border: 1px solid var(--warning-glow);
  backdrop-filter: blur(5px);
}

.stock-info {
  color: var(--text-color);
  font-size: .95rem;
  font-weight: 500;
  padding: .3rem .6rem;
  background: var(--overlay-light);
  border-radius: 6px;
  border: 1px solid var(--overlay-medium);
  display: inline-block;
}

/* Purchase CTA (fancy) */

/* Faction store responsive tweaks */
@media (max-width:768px){
  .store-header{ flex-direction:column; align-items:flex-start; gap:1.5rem; padding:1.5rem; }
  .trainer-currency{ width:100%; justify-content:space-between; }
  .store-items-grid{ grid-template-columns:1fr; gap:1.5rem; }
  .store-item-card{ padding:1.5rem; }
  .store-item-card .item-header{ flex-direction:column; align-items:center; gap:1rem; text-align:center; }
  .item-icon{ align-self:center; }
  .store-item-card .item-details{ text-align:center; }
}
@media (max-width:480px){
  .faction-store{ padding:0 1rem; }
  .store-header{ padding:1.25rem; gap:1rem; }
  .store-header h3{ font-size:1.5rem; }
  .trainer-currency{ padding:.75rem 1rem; }
  .currency-amount{ font-size:1.1rem; }
  .store-items-grid{ gap:1.25rem; }
  .store-item-card{ padding:1.25rem; }
  .item-icon{ width:50px; height:50px; font-size:2rem; }
  .store-item-card .item-name{ font-size:1.2rem; }
}

/* ====================================================================== */
/* PURCHASE MODAL (manager/shop)                                          */
/* ====================================================================== */

.purchase-modal-overlay {
  position: fixed;
  inset: 0;
  background: var(--overlay-solid);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 1000;
}

.purchase-modal {
  background: var(--card-background);
  border-radius: var(--radius);
  width: 90%;
  max-width: 500px;
  max-height: 90vh;
  overflow-y: auto;
  box-shadow: var(--shadow-2);
  display: flex;
  flex-direction: column;
}

.purchase-modal-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 15px 20px;
  border-bottom: 1px solid var(--border-color);
}

.purchase-modal-header h2{ margin:0; font-size:1.5rem; color:var(--text-color); }

/* Close buttons: Use unified button system - className="button close positioned" */

.purchase-modal-content {
  padding: 20px;
  flex-grow: 1;
}

.item-preview {
  display: flex;
  gap: 15px;
  margin-bottom: 20px;
}

.item-preview-image {
  width: 80px;
  height: 80px;
  object-fit: contain;
  background: var(--card-background);
  border-radius: var(--radius-sm);
  padding: 5px;
}

.item-preview-details {
  flex: 1;
}

.item-preview-name {
  margin: 0 0 5px 0;
  font-size: 1.2rem;
  color: var(--text-color);
}

.item-preview-description {
  margin: 0;
  font-size: .9rem;
  color: var(--text-color);
}

.purchase-details {
  background: var(--card-background);
  padding: 15px;
  border-radius: var(--radius-sm);
}

.quantity-control label{ font-weight:700; color:var(--text-color); }
.quantity-input-group input{
  width:50px; height:30px; text-align:center; border:none; background:var(--card-background); color:var(--text-color);
  -moz-appearance:textfield;
}
.quantity-input-group input::-webkit-outer-spin-button,
.quantity-input-group input::-webkit-inner-spin-button{ -webkit-appearance:none; margin:0; }

.price-summary {
  margin-bottom: 15px;
}

.price-row {
  display: flex;
  justify-content: space-between;
  margin-bottom: 5px;
  color: var(--text-color);
}

.price-row.total{ font-weight:700; color:var(--text-color); border-top:1px solid var(--border-color); padding-top:5px; margin-top:5px; }
.price-row i{ color:var(--accent-color); }

/* Simple alerts in modal scope */
.purchase-modal .purchase-error{
  background:var(--error-glow-light); color:var(--error-color);
  padding:10px; border-radius:var(--radius-sm); margin-top:15px; text-align:center;
}
.purchase-modal .purchase-success{
  background:var(--success-glow-light); color:var(--success-color);
  padding:10px; border-radius:var(--radius-sm); margin-top:15px; text-align:center;
}

.purchase-modal-actions {
  display: flex;
  justify-content: flex-end;
  gap: 10px;
  padding: 15px 20px;
  border-top: 1px solid var(--border-color);
}

@media (max-width:480px){
  .item-preview{ flex-direction:column; align-items:center; text-align:center; }
  .item-preview-image{ width:100px; height:100px; }
  .quantity-control{ flex-direction:column; align-items:flex-start; gap:10px; }
}

/* ====================================================================== */
/* RESPONSIVE: hero & controls                                            */
/* ====================================================================== */

@media (max-width:768px){
  .shop-header{ height:150px; }
  .shop-title{ font-size:1.8rem; }
  .shop-description{ font-size:1rem; max-width:100%; }
  .shop-controls{ 
    padding: 12px; 
  }
  .trainer-selection {
    flex-direction: column;
    align-items: stretch;
    gap: 10px;
  }
  .shop-search {
    flex-direction: column;
    align-items: stretch;
    gap: 10px;
  }
}

/* ====================================================================== */
/* BERRY AND PASTRY FILTERS                                               */
/* ====================================================================== */

.berry-filters,
.pastry-filters {
  padding: 1rem;
  background: var(--card-background);
  border: 1px solid var(--border-color);
  border-radius: var(--radius);
  margin: 1rem 0;
  box-shadow: var(--shadow-1);
}

.berry-filters h4,
.pastry-filters h4 {
  margin-bottom: 0.75rem;
  color: var(--accent-color);
  font-size: 1rem;
  font-weight: 600;
}